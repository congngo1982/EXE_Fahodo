<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fahodo</title>
    <link rel="stylesheet" href="styles/style_index.css">
    <link rel="stylesheet" href="styles/style_category.css">
    <script src="action/ultils.js"></script>
    <script src="action/action_index.js"></script>

</head>

<body onload="OnLoadMain()">
    <div id="header" w3-include-html="header.html"
        style="position: relative; width: 90%; margin-left: 5%; background-color: white; z-index: 2;"></div>

    <div class="body">
        <h4 class="cate_CategoryName">
            Happy
        </h4>
        <div class="row" id="happyCate">
            <div class="col-6 col-xs-6 col-sm-3 col-md-3 col-lg-3" style="padding: 2%;">
                <div class="book">
                    <div class="panel">
                        <img class="poster" src="images/conan.jpg" alt="">
                    </div>
                    <div class="title">
                        <h5 style="height: 40px; overflow: hidden;">Conan</h5>
                        <div>Gosho Aoyama</div>
                        <div>⭐⭐⭐⭐⭐</div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-xs-6 col-sm-3 col-md-3 col-lg-3" style="padding: 2%;">
                <div class="book">
                    <div class="panel">
                        <img class="poster" src="images/conan.jpg" alt="">
                    </div>
                    <div class="title">
                        <h5 style="height: 40px; overflow: hidden;">Conan</h5>
                        <div>Gosho Aoyama</div>
                        <div>⭐⭐⭐⭐⭐</div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-xs-6 col-sm-3 col-md-3 col-lg-3" style="padding: 2%;">
                <div class="book">
                    <div class="panel">
                        <img class="poster" src="images/conan.jpg" alt="">
                    </div>
                    <div class="title">
                        <h5 style="height: 40px; overflow: hidden;">Conan</h5>
                        <div>Gosho Aoyama</div>
                        <div>⭐⭐⭐⭐⭐</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="body">
        <h4 class="cate_CategoryName">
            Drama
        </h4>
        <div class="row" id="dramaCa">
            <div class="col-6 col-xs-6 col-sm-3 col-md-3 col-lg-3" style="padding: 2%;">
                <div class="book">
                    <div class="panel">
                        <img class="poster" src="images/conan.jpg" alt="">
                    </div>
                    <div class="title">
                        <h5 style="height: 40px; overflow: hidden;">Conan</h5>
                        <div>Gosho Aoyama</div>
                        <div>⭐⭐⭐⭐⭐</div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-xs-6 col-sm-3 col-md-3 col-lg-3" style="padding: 2%;">
                <div class="book">
                    <div class="panel">
                        <img class="poster" src="images/conan.jpg" alt="">
                    </div>
                    <div class="title">
                        <h5 style="height: 40px; overflow: hidden;">Conan</h5>
                        <div>Gosho Aoyama</div>
                        <div>⭐⭐⭐⭐⭐</div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-xs-6 col-sm-3 col-md-3 col-lg-3" style="padding: 2%;">
                <div class="book">
                    <div class="panel">
                        <img class="poster" src="images/conan.jpg" alt="">
                    </div>
                    <div class="title">
                        <h5 style="height: 40px; overflow: hidden;">Conan</h5>
                        <div>Gosho Aoyama</div>
                        <div>⭐⭐⭐⭐⭐</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="body">
        <h4 class="cate_CategoryName">
            Action
        </h4>
        <div class="row" id="actionCate">
            <div class="col-6 col-xs-6 col-sm-3 col-md-3 col-lg-3" style="padding: 2%;">
                <div class="book">
                    <div class="panel">
                        <img class="poster" src="images/conan.jpg" alt="">
                    </div>
                    <div class="title">
                        <h5 style="height: 40px; overflow: hidden;">Conan</h5>
                        <div>Gosho Aoyama</div>
                        <div>⭐⭐⭐⭐⭐</div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-xs-6 col-sm-3 col-md-3 col-lg-3" style="padding: 2%;">
                <div class="book">
                    <div class="panel">
                        <img class="poster" src="images/conan.jpg" alt="">
                    </div>
                    <div class="title">
                        <h5 style="height: 40px; overflow: hidden;">Conan</h5>
                        <div>Gosho Aoyama</div>
                        <div>⭐⭐⭐⭐⭐</div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-xs-6 col-sm-3 col-md-3 col-lg-3" style="padding: 2%;">
                <div class="book">
                    <div class="panel">
                        <img class="poster" src="images/conan.jpg" alt="">
                    </div>
                    <div class="title">
                        <h5 style="height: 40px; overflow: hidden;">Conan</h5>
                        <div>Gosho Aoyama</div>
                        <div>⭐⭐⭐⭐⭐</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div style="margin-top: 2%;" w3-include-html="footer.html"></div>

    <script>
        window.onscroll = OnScroll;
        includeHTML();

        var head = document.getElementById("header");
        head.getAttribute("hehe");
        console.log(head.getAttribute("header"))

        function OnLoadMain() {
            CallAjax("GET", "/book/getbook/tuoi tho", GetBookCate, "happyCate");
        }

        function GetBookCate(result, sectionId) {
            result = JSON.parse(result);

            var bookTemplate = function (id, img, name, author, rating) {
                var rate = "⭐⭐⭐⭐⭐";
                if (rating < 2.0) {
                    rate = "⭐";
                } else if (rating < 3.0) {
                    rate = "⭐⭐"
                } else if (rating < 4.0) {
                    rate = "⭐⭐⭐";
                } else if (rating < 5.0) {
                    rate = "⭐⭐⭐⭐";
                }
                return `<div class="col-6 col-xs-6 col-sm-3 col-md-3 col-lg-3" style="padding: 2%;">
                    <a href="book.html?id=${id}" style="text-decoration: none; color: black;">
                    <div class="book">
                                <div class="panel">
                                    <img class="poster" src="${img}" alt="">
                                </div>
                                <div class="title">
                                    <h5 style="height: 25px; overflow: hidden;">${name}</h5>
                                    <div>${author}</div>
                                    <div>${rate}</div>
                                </div>
                            </div>
                        </a>
                        </div>`;
            }
            var book = "";
            result.forEach(element => {
                var images = element.bookImages;
                var img = "";
                images.forEach(imgE => {
                    if (imgE.type == "poster") {
                        img = imgE.source;
                    }
                });
                book += bookTemplate(element.id, img, element.title, element.author.fullName, element.rating);
            });
            document.getElementById(sectionId).innerHTML = book;
            console.log(result);
        }

        function CallAjax(method, url, funcCallBack, sectionId) {
            const xhttp = new XMLHttpRequest();
            var result;
            xhttp.onload = function () {
                funcCallBack(this.responseText, sectionId);
            }
            xhttp.open(method, url);
            xhttp.send();
        }
    </script>

</body>

</html>